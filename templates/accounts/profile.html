{% extends "base/base.html" %}
{% block start %}
{% block content %}

<div
  style="
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
    background: #f9f9f9;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  "
>
  <br>
  <h2>User Profile</h2>

  <!-- Display success or error messages -->
  {% if messages %}
    <ul>
      {% for message in messages %}
        <li style="color: {% if message.tags == 'error' %}red{% else %}green{% endif %};">
          {{ message }}
        </li>
      {% endfor %}
    </ul>
  {% endif %}

  <!-- Profile Info -->
  <form
    method="POST"
    enctype="multipart/form-data"
    action="{% url 'user_profile' %}"
  >
    {% csrf_token %}
    <div style="margin-bottom: 15px">
      <label for="first_name">First Name:</label>
      <input
        type="text"
        id="first_name"
        name="first_name"
        value="{{ user.first_name }}"
        style="
          width: 100%;
          padding: 10px;
          border: 1px solid #ccc;
          border-radius: 4px;
        "
      />
    </div>

    <div style="margin-bottom: 15px">
      <label for="last_name">Last Name:</label>
      <input
        type="text"
        id="last_name"
        name="last_name"
        value="{{ user.last_name }}"
        style="
          width: 100%;
          padding: 10px;
          border: 1px solid #ccc;
          border-radius: 4px;
        "
      />
    </div>

    <div style="margin-bottom: 15px">
      <label for="email">Email:</label>
      <input
        type="email"
        id="email"
        name="email"
        value="{{ user.email }}"
        style="
          width: 100%;
          padding: 10px;
          border: 1px solid #ccc;
          border-radius: 4px;
        "
      />
    </div>

    <!-- Button to Toggle Password Update Section -->
    <button
      type="button"
      id="togglePasswordSectionBtn"
      onclick="togglePasswordSectionVisibility()"
      style="
        padding: 10px 20px;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin-bottom: 20px;
      "
    >
      Update Password
    </button>

    <!-- Password Update Section -->
    <div id="passwordSection" style="display: none;">
      <h3>Change Password</h3>
      <div style="margin-bottom: 15px">
        <label for="current_password">Current Password:</label>
        <input
          type="password"
          id="current_password"
          name="current_password"
          style="
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
          "
        />
      </div>

      <div style="margin-bottom: 15px">
        <label for="new_password">New Password:</label>
        <input
          type="password"
          id="new_password"
          name="new_password"
          style="
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
          "
        />
      </div>

      <div style="margin-bottom: 15px">
        <label for="confirm_password">Confirm New Password:</label>
        <input
          type="password"
          id="confirm_password"
          name="confirm_password"
          style="
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
          "
        />
      </div>

      <!-- Show Password Checkbox -->
      <div style="margin-bottom: 15px">
        <input
          type="checkbox"
          id="show_password"
          onclick="togglePasswordVisibility()"
        />
        <label for="show_password">Show Password</label>
      </div>
    </div>

    <button
      type="submit"
      style="
        padding: 10px 20px;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      "
    >
      Save Changes
    </button>
  </form>
</div>

<script>
  // Toggle the visibility of the password update section
  function togglePasswordSectionVisibility() {
    const passwordSection = document.getElementById('passwordSection');
    const toggleButton = document.getElementById('togglePasswordSectionBtn');

    if (passwordSection.style.display === 'none') {
      passwordSection.style.display = 'block';
      toggleButton.textContent = 'Hide Password Update';
    } else {
      passwordSection.style.display = 'none';
      toggleButton.textContent = 'Update Password';
    }
  }

  // Toggle password visibility
  function togglePasswordVisibility() {
    const currentPassword = document.getElementById('current_password');
    const newPassword = document.getElementById('new_password');
    const confirmPassword = document.getElementById('confirm_password');
    const type =
      currentPassword.type === 'password' ? 'text' : 'password';

    currentPassword.type = type;
    newPassword.type = type;
    confirmPassword.type = type;
  }
</script>

{% endblock %}
{% endblock %}
